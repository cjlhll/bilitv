# 影视列表API接口文档

## 概述

本文档描述了PiliPlus应用中影视列表页面的数据获取逻辑，包括API接口、参数说明和返回数据结构。影视列表页面包含5个主要分类：全部、电影、电视剧、纪录片、综艺，并提供多种筛选条件。

## 页面结构

影视列表页面分为三个主要部分：
1. **顶部Tab栏**：包含5个分类（全部、电影、电视剧、纪录片、综艺）
2. **筛选条件区域**：提供多种筛选选项，支持展开/收起
3. **视频卡片列表**：展示筛选后的影视内容

## API接口

### 1. 获取筛选条件接口

**接口地址：** `/pgc/season/index/condition`

**请求方式：** GET

**请求参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| season_type | int | 否 | 季节类型，默认1 |
| type | int | 否 | 类型，默认0 |
| index_type | int | 否 | 索引类型，对应不同分类：102(全部)、2(电影)、5(电视剧)、3(纪录片)、7(综艺) |

**响应数据结构：**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "filter": [
      {
        "field": "筛选字段名",
        "name": "筛选条件显示名称",
        "values": [
          {
            "keyword": "筛选值关键词",
            "name": "筛选值显示名称"
          }
        ]
      }
    ],
    "order": [
      {
        "field": "排序字段名",
        "name": "排序显示名称",
        "sort": "排序方式"
      }
    ]
  }
}
```

**字段说明：**
- `filter`: 筛选条件列表
  - `field`: 筛选条件的字段标识，用于请求参数
  - `name`: 筛选条件的显示名称
  - `values`: 可选值列表
    - `keyword`: 筛选值的关键词，用于请求参数
    - `name`: 筛选值的显示名称
- `order`: 排序方式列表
  - `field`: 排序字段标识，用于请求参数
  - `name`: 排序方式的显示名称
  - `sort`: 排序方式标识

### 2. 获取影视列表接口

**接口地址：** `/pgc/season/index/result`

**请求方式：** GET

**请求参数：**
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | int | 是 | 页码，从1开始 |
| pagesize | int | 是 | 每页数量，默认21 |
| season_type | int | 否 | 季节类型，默认1 |
| type | int | 否 | 类型，默认0 |
| index_type | int | 否 | 索引类型，对应不同分类：102(全部)、2(电影)、5(电视剧)、3(纪录片)、7(综艺) |
| order | string | 否 | 排序字段，由筛选条件接口获取 |
| 其他筛选参数 | - | 否 | 根据筛选条件接口获取的field和keyword组合 |

**响应数据结构：**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "has_next": 1,
    "list": [
      {
        "badge": "标签",
        "badge_info": {
          "bg_color": "背景颜色",
          "bg_color_night": "夜间背景颜色",
          "text": "标签文本",
          "text_color": "文字颜色",
          "text_color_night": "夜间文字颜色"
        },
        "badge_type": 1,
        "cover": "封面图片URL",
        "first_ep": {
          "cover": "首集封面",
          "duration": "时长",
          "ep_id": 1,
          "index": "集数",
          "index_title": "标题",
          "long_title": "长标题"
        },
        "index_show": "索引显示",
        "is_finish": 1,
        "link": "链接地址",
        "media_id": 123456,
        "order": "排序",
        "order_type": "排序类型",
        "score": "评分",
        "season_id": 123456,
        "season_status": 1,
        "season_type": 1,
        "subTitle": "副标题",
        "title": "标题",
        "title_icon": "标题图标"
      }
    ],
    "num": 21,
    "size": 21,
    "total": 1000
  }
}
```

**字段说明：**
- `has_next`: 是否有下一页，0表示没有，1表示有
- `list`: 影视列表数据
  - `badge`: 角标标签文本
  - `badge_info`: 角标详细信息
    - `bg_color`: 背景颜色
    - `bg_color_night`: 夜间模式背景颜色
    - `text`: 标签文本
    - `text_color`: 文字颜色
    - `text_color_night`: 夜间模式文字颜色
  - `badge_type`: 角标类型
  - `cover`: 封面图片URL
  - `first_ep`: 第一集信息
    - `cover`: 首集封面图
    - `duration`: 时长
    - `ep_id`: 集ID
    - `index`: 集数
    - `index_title`: 标题
    - `long_title`: 长标题
  - `index_show`: 索引显示信息
  - `is_finish`: 是否完结，0表示未完结，1表示已完结
  - `link`: 链接地址
  - `media_id`: 媒体ID
  - `order`: 排序信息
  - `order_type`: 排序类型
  - `score`: 评分
  - `season_id`: 季ID
  - `season_status`: 季状态
  - `season_type`: 季类型
  - `subTitle`: 副标题
  - `title`: 标题
  - `title_icon`: 标题图标
- `num`: 当前页数量
- `size`: 每页大小
- `total`: 总数量

## 数据获取流程

1. **初始化页面**：
   - 调用筛选条件接口获取可用的筛选条件和排序方式
   - 根据默认筛选条件调用影视列表接口获取初始数据

2. **切换分类**：
   - 根据不同的`index_type`参数重新获取筛选条件和列表数据

3. **应用筛选条件**：
   - 用户选择筛选条件后，将对应的`field`和`keyword`作为参数请求新的列表数据

4. **加载更多**：
   - 滚动到底部时，增加`page`参数请求下一页数据

## 分类说明

| 分类名称 | index_type | 说明 |
|----------|------------|------|
| 全部 | 102 | 包含所有类型的影视内容 |
| 电影 | 2 | 电影类内容 |
| 电视剧 | 5 | 电视剧类内容 |
| 纪录片 | 3 | 纪录片类内容 |
| 综艺 | 7 | 综艺类内容 |

## 筛选条件示例

常见的筛选条件包括：
- 地区：内地、韩国、日本、美国等
- 年份：2024、2023、2022等
- 状态：完结、连载中
- 类型：爱情、悬疑、动作、喜剧等
- 排序：最新上映、最多播放、最高评分等

## 注意事项

1. 所有接口请求都需要携带必要的认证信息
2. 筛选条件和排序方式可能会根据不同的`index_type`有所变化
3. 分页加载时需要保持筛选条件不变，只改变`page`参数
4. 封面图片建议使用合适的加载策略和缓存机制